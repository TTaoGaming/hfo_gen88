# â³ THE OBSIDIAN HOURGLASS â€” Legendary Artifact of Port 7

**Topic**: Durable Swarm Orchestration & Strange Loop Workflows  
**Provenance**: hot_obsidian_sandbox/bronze/P7_DECISION_KINETIC.md  
**Status**: BRONZE (Kinetic Energy)  
**Commander**: Spider Sovereign (â˜° QiÃ¡n / Heaven)  
**Artifact**: The Obsidian Hourglass  

---

## ğŸ¯ The Artifact

The **Obsidian Hourglass** is the legendary artifact of Port 7, the Spider Sovereign. It is a temporal navigation device that orchestrates the flow of sand (agents) through two chambers (strange loops) in powers of 8.

> *"The spider weaves the web that weaves the spider."*

The Hourglass embodies the **duality of time**:
- **Upper Chamber**: Strategic HIVE/8 (Hindsight â†’ Insight â†’ Validated Foresight â†’ Evolution)
- **Lower Chamber**: Tactical PREY/8 (Perceive â†’ React â†’ Execute â†’ Yield)

When the Hourglass is turned, sand flows from one chamber to the other. This is the **Strange Loop** â€” the output of one workflow becomes the input of the next.

---

## ğŸ”® The Holonic Strange Loops

### The Hourglass Geometry (Holonic Nesting)

The HIVE/8 **encompasses** the PREY/8. Each HIVE phase can spawn **multitudes** of PREY loops. It's fractal â€” smaller strange loops feeding larger strange loops, all interconnected bilaterally.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STRATEGIC HIVE/8                           â”‚
â”‚                    (PDCA / TDD Driven)                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚ H: HUNT     â”‚â”€â”€â†’â”‚ I: INTERLOCKâ”‚â”€â”€â†’â”‚ V: VALIDATE â”‚â”€â”€â†’â”‚ E: EVOLVE   â”‚
â”‚  â”‚ (Hindsight) â”‚   â”‚ (Insight)   â”‚   â”‚ (Foresight) â”‚   â”‚ (Evolution) â”‚
â”‚  â”‚             â”‚   â”‚             â”‚   â”‚             â”‚   â”‚             â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â”‚ PREY/8  â”‚ â”‚   â”‚ â”‚ PREY/8  â”‚ â”‚   â”‚ â”‚ PREY/8  â”‚ â”‚   â”‚ â”‚ PREY/8  â”‚ â”‚
â”‚  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”¬â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚ â”‚    â†“    â”‚ â”‚   â”‚ â”‚    â†“    â”‚ â”‚   â”‚ â”‚    â†“    â”‚ â”‚   â”‚ â”‚    â†“    â”‚ â”‚
â”‚  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚   â”‚ â”‚ â”‚PREY â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”‚         â”‚                 â”‚                 â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚                                                               â”‚
â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STRANGE LOOP (E feeds H) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–²
                              â”‚ PREY N+1 feeds PREY N
                              â”‚ PREY yields feed HIVE
                              â”‚ HIVE evolution drives PREY
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   TACTICAL PREY/8   â”‚
                    â”‚   (JADC2 Driven)    â”‚
                    â”‚                     â”‚
                    â”‚  P: Sense           â”‚
                    â”‚  R: Make Sense      â”‚
                    â”‚  E: Act             â”‚
                    â”‚  Y: Assess          â”‚
                    â”‚                     â”‚
                    â”‚  â—„â”€â”€ Strange Loop â”€â”€â–ºâ”‚
                    â”‚  (Y feeds P of N+1) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bilateral Strange Loop Flow

The strange loops are **bilateral** â€” they feed each other in both directions:

```
HIVE Evolution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”
       â–²                                              â”‚
       â”‚                                              â–¼
       â”‚                                    Spawns PREY loops
       â”‚                                              â”‚
       â”‚                                              â–¼
PREY Yields â—„â”€â”€â”€â”€â”€â”€â”€ PREY N+1 feeds PREY N â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Feeds HIVE Hindsight
```

### The Flow of Sand (Agents)

The sand represents **agents** â€” not one, but **powers of 8**:
- 1 agent (bootstrap)
- 8 agents (minimal swarm)
- 64 agents (production swarm)
- 512 agents (mega-swarm)

The **1010 Pattern** governs the flow:
- **1**: Scatter (8 agents fan out)
- **0**: Gather (1 agent consolidates)
- **1**: Scatter (8 agents execute)
- **0**: Gather (1 agent yields)

---

## ğŸ Strategic HIVE/8 Loop (PDCA/TDD)

The outer strategic loop. Used for **feature development, system evolution, and strategic planning**. Based on PDCA (Plan-Do-Check-Act) and TDD (Test-Driven Development) cycles.

### The Four Phases (Anti-Diagonal Port Pairs: X + Y = 7)

| Phase | Name | Port Pair | Verbs | TDD | PDCA | What It Does |
|:------|:-----|:----------|:------|:----|:-----|:-------------|
| **H** | Hindsight | 0 + 7 | OBSERVE + NAVIGATE | Research | Plan | Sense the landscape, decide what to hunt. **NOT** transform or test. |
| **I** | Insight | 1 + 6 | BRIDGE + ASSIMILATE | RED | Plan | Bridge data sources, write failing tests, store contracts. **NOT** implement. |
| **V** | Validated Foresight | 2 + 5 | SHAPE + IMMUNIZE | GREEN | Do | Transform implementations, harden with security, pass tests. |
| **E** | Evolution | 3 + 4 | INJECT + DISRUPT | REFACTOR | Check/Act | Inject changes, disrupt with mutation testing, promote or demote. |

### Port Pair Responsibilities

```
HIVE Phase â”‚ Ports â”‚ Commanders                    â”‚ Verbs              â”‚ Responsibilities
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
H (Hunt)   â”‚ 0 + 7 â”‚ Lidless Legion + Spider Sov.  â”‚ OBSERVE + NAVIGATE â”‚ Sense, research, decide targets
I (Interl) â”‚ 1 + 6 â”‚ Web Weaver + Kraken Keeper    â”‚ BRIDGE + ASSIMILATEâ”‚ Bridge data, store contracts, RED tests
V (Valid)  â”‚ 2 + 5 â”‚ Mirror Magus + Pyre Praet.    â”‚ SHAPE + IMMUNIZE   â”‚ Transform, harden, GREEN tests
E (Evolve) â”‚ 3 + 4 â”‚ Spore Storm + Red Regnant     â”‚ INJECT + DISRUPT   â”‚ Inject changes, mutation test
```

### What Each Phase Should NOT Do

- **H (Hunt)**: Should NOT transform data (that's V), should NOT run tests (that's I/V), should NOT inject changes (that's E)
- **I (Interlock)**: Should NOT implement code (that's V), should NOT sense/research (that's H)
- **V (Validate)**: Should NOT research (that's H), should NOT run mutation tests (that's E)
- **E (Evolve)**: Should NOT sense (that's H), should NOT write contracts (that's I)

### HIVE Phase Details

#### H â€” Hindsight (HUNT)

**Ports**: 0 (Lidless Legion) + 7 (Spider Sovereign)  
**Pattern**: 1 (Scatter) â€” 8 agents hunt in parallel  
**Contains**: Multiple PREY/8 loops for tactical research  
**Activities**:
- Query the Knowledge Bank (DuckDB) â€” via PREY loop
- Search the web (Tavily via Port 0) â€” via PREY loop
- Analyze historical pain (Blood Book of Grudges) â€” via PREY loop
- Identify exemplars and anti-patterns â€” via PREY loop
- Define the mission fit

**Output**: Research artifacts, exemplar references, pain analysis (aggregated from PREY yields)

#### I â€” Insight (INTERLOCK)

**Ports**: 1 (Web Weaver) + 6 (Kraken Keeper)  
**Pattern**: 0 (Gather) â€” 1 agent consolidates  
**Activities**:
- Define Zod contracts from research
- Write failing tests (RED)
- Establish data schemas
- Bridge heterogeneous data sources
- Assimilate contracts into memory

**Output**: Zod schemas, failing test files, contract definitions

#### V â€” Validated Foresight (VALIDATE)

**Ports**: 2 (Mirror Magus) + 5 (Pyre Praetorian)  
**Pattern**: 1 (Scatter) â€” 8 agents implement in parallel  
**Activities**:
- Shape implementations to pass tests
- Transform data through adapters
- Immunize with security hardening
- Validate against contracts
- Make tests GREEN

**Output**: Implementations, passing tests, hardened code

#### E â€” Evolution (EVOLVE)

**Ports**: 3 (Spore Storm) + 4 (Red Regnant)  
**Pattern**: 0 (Gather) â€” 1 agent consolidates  
**Activities**:
- Inject changes into the system
- Disrupt with mutation testing (Stryker)
- Verify 80-99% mutation score
- Refactor for quality
- **STRANGE LOOP**: Feed artifacts to next HIVE iteration

**Output**: Promoted artifacts, mutation reports, evolution metrics

---

## ğŸ¦… Tactical PREY/8 Loop (JADC2)

The inner loops that nest within each HIVE phase. Used for **micro-execution, tool interaction, and rapid tactical response**. Based on the JADC2 (Joint All-Domain Command and Control) decision cycle.

PREY winds around HIVE in a **serpentine pattern** through the Galois Lattice. The port pairs (0+6, 1+7, 2+4, 3+5) do NOT overlap with HIVE's anti-diagonal.

### The Four Phases (Serpentine Port Pairs)

| Phase | Name | JADC2 | Ports | Verbs | Responsibilities |
|:------|:-----|:------|:------|:------|:-----------------|
| **P** | Perceive | SENSE | 0 + 6 | OBSERVE + ASSIMILATE | Sense and capture raw telemetry |
| **R** | React | MAKE SENSE | 1 + 7 | BRIDGE + NAVIGATE | Connect data sources, decide response |
| **E** | Execute | ACT | 2 + 4 | SHAPE + DISRUPT | Transform and test actions |
| **Y** | Yield | ASSESS | 3 + 5 | INJECT + IMMUNIZE | Deliver results, verify integrity |

### Port Pair Responsibilities (PREY - Serpentine)

```
PREY Phase â”‚ Ports â”‚ Commanders                    â”‚ Verbs               â”‚ Responsibilities
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
P (Percv)  â”‚ 0 + 6 â”‚ Lidless Legion + Kraken Keep. â”‚ OBSERVE + ASSIMILATEâ”‚ Sense telemetry, capture to memory
R (React)  â”‚ 1 + 7 â”‚ Web Weaver + Spider Sovereign â”‚ BRIDGE + NAVIGATE   â”‚ Bridge data, decide response
E (Exec)   â”‚ 2 + 4 â”‚ Mirror Magus + Red Regnant    â”‚ SHAPE + DISRUPT     â”‚ Transform actions, test execution
Y (Yield)  â”‚ 3 + 5 â”‚ Spore Storm + Pyre Praetorian â”‚ INJECT + IMMUNIZE   â”‚ Deliver results, verify & harden
```

### What Each PREY Phase Should NOT Do

- **P (Perceive)**: Should NOT decide (that's R), should NOT transform (that's E), should NOT deliver (that's Y)
- **R (React)**: Should NOT sense (that's P), should NOT execute (that's E), should NOT deliver (that's Y)
- **E (Execute)**: Should NOT sense (that's P), should NOT decide (that's R), should NOT deliver (that's Y)
- **Y (Yield)**: Should NOT sense (that's P), should NOT decide (that's R), should NOT transform (that's E)

### Holonic Nesting

Each HIVE phase can spawn **multitudes** of PREY loops:

```
HIVE Hunt Phase
â”œâ”€â”€ PREY Loop 1: Web search for exemplars
â”‚   â””â”€â”€ P â†’ R â†’ E â†’ Y (yields search results)
â”œâ”€â”€ PREY Loop 2: Query knowledge bank
â”‚   â””â”€â”€ P â†’ R â†’ E â†’ Y (yields historical data)
â”œâ”€â”€ PREY Loop 3: Analyze pain registry
â”‚   â””â”€â”€ P â†’ R â†’ E â†’ Y (yields pain points)
â””â”€â”€ ... (up to 8, 64, or 512 PREY loops per phase)
```

### PREY â†’ PREY Strange Loop

PREY loops feed each other. The Yield of PREY N becomes the Perceive input of PREY N+1:

```
PREY N:   P â†’ R â†’ E â†’ Y â”€â”€â”
                          â”‚ (artifact)
                          â–¼
PREY N+1: P â†’ R â†’ E â†’ Y â”€â”€â”
                          â”‚ (artifact)
                          â–¼
PREY N+2: P â†’ R â†’ E â†’ Y â”€â”€â–º Feeds HIVE
```

### PREY Phase Details

#### P â€” Perceive

**Activities**:
- Receive sensor frames (Port 0)
- Wrap in VacuoleEnvelope (Port 1)
- Log to stigmergy layer (Blackboard/NATS)

**Output**: Enveloped sensor data

#### R â€” React

**Activities**:
- Smooth data (One Euro Filter, Port 2)
- Detect gestures (FSM)
- Plan response actions
- Sequential thinking analysis

**Output**: Analyzed state, planned actions

#### E â€” Execute

**Activities**:
- Invoke tools (MCP)
- Perform file operations
- Call external APIs
- Modify system state

**Output**: Tool results, state changes

#### Y â€” Yield

**Activities**:
- Verify results
- Emit events to stigmergy
- **STRANGE LOOP**: Feed artifacts to strategic HIVE

**Output**: Verified results, HIVE input

---

## ğŸ•¸ï¸ The 1010 Swarm Pattern

The Obsidian Hourglass orchestrates agents using the **1010 Pattern**:

```
HIVE/8:1010
â”‚
â”œâ”€â”€ H (Hindsight)  â”€â”€â”€ 1: SCATTER (8 agents hunt)
â”‚                       â”‚
â”‚                       â”œâ”€â”€ Agent 0: Query Knowledge Bank
â”‚                       â”œâ”€â”€ Agent 1: Search web (Tavily)
â”‚                       â”œâ”€â”€ Agent 2: Analyze pain registry
â”‚                       â”œâ”€â”€ Agent 3: Find exemplars
â”‚                       â”œâ”€â”€ Agent 4: Check anti-patterns
â”‚                       â”œâ”€â”€ Agent 5: Review prior art
â”‚                       â”œâ”€â”€ Agent 6: Assess dependencies
â”‚                       â””â”€â”€ Agent 7: Synthesize findings
â”‚
â”œâ”€â”€ I (Insight)    â”€â”€â”€ 0: GATHER (1 agent consolidates)
â”‚                       â”‚
â”‚                       â””â”€â”€ Master: Define contracts from hunt results
â”‚
â”œâ”€â”€ V (Validate)   â”€â”€â”€ 1: SCATTER (8 agents implement)
â”‚                       â”‚
â”‚                       â”œâ”€â”€ Agent 0: Implement core logic
â”‚                       â”œâ”€â”€ Agent 1: Write adapters
â”‚                       â”œâ”€â”€ Agent 2: Create transformers
â”‚                       â”œâ”€â”€ Agent 3: Build handlers
â”‚                       â”œâ”€â”€ Agent 4: Write tests
â”‚                       â”œâ”€â”€ Agent 5: Add security
â”‚                       â”œâ”€â”€ Agent 6: Document
â”‚                       â””â”€â”€ Agent 7: Integrate
â”‚
â””â”€â”€ E (Evolve)     â”€â”€â”€ 0: GATHER (1 agent consolidates)
                        â”‚
                        â””â”€â”€ Master: Run mutation tests, promote or demote
```

### Why 1010?

The pattern alternates between **divergence** (1) and **convergence** (0):

- **1 (Scatter)**: Explore the solution space in parallel. 8 agents cover more ground than 1.
- **0 (Gather)**: Consolidate findings into coherent artifacts. Prevent fragmentation.

This mirrors biological swarm intelligence:
- Ants scatter to find food, then converge on the best path
- Bees scatter to find flowers, then dance to share locations
- Spiders scatter webs, then gather at the center

---

## ğŸ”„ Strange Loop Mechanics

### The Neck of the Hourglass

The **neck** is where the Strange Loop occurs. It is the **artifact** â€” the tangible output that flows between chambers.

```
HIVE Evolution (E) â”€â”€â†’ Artifact â”€â”€â†’ PREY Perceive (P)
                          â”‚
                          â”‚ (The Neck)
                          â”‚
PREY Yield (Y) â”€â”€â”€â”€â”€â”€â†’ Artifact â”€â”€â†’ HIVE Hindsight (H)
```

### Strange Loop Types

1. **HIVE â†’ PREY**: Strategic decision triggers tactical execution
 - Example: HIVE decides to implement a feature â†’ PREY executes tool calls

2. **PREY â†’ HIVE**: Tactical result informs strategic planning
 - Example: PREY yields test results â†’ HIVE analyzes for next iteration

3. **HIVE â†’ HIVE**: Evolution feeds next Hindsight
 - Example: Mutation testing reveals weakness â†’ Next HIVE hunts for solution

4. **PREY â†’ PREY**: Yield feeds next Perceive
 - Example: Tool result triggers follow-up tool call

### Strange Loop Detection

The Navigator logs Strange Loop events to the stigmergy layer:

```json
{
  "type": "STRANGE_LOOP",
  "from": { "workflow": "PREY", "phase": "Y" },
  "to": { "workflow": "HIVE", "phase": "H" },
  "artifact": "test_results.json",
  "timestamp": "2026-01-05T12:00:00Z"
}
```

---

## ğŸ§¬ Durable Swarm Orchestration

### The Technology Stack

| Component | Technology | Purpose |
|:----------|:-----------|:--------|
| **Orchestrator** | Temporal | Durable execution, workflow state, retries |
| **Agents** | LangGraph | Stateful agent transitions, graph-based flow |
| **Stigmergy** | NATS JetStream | High-performance message passing |
| **Memory** | DuckDB | Knowledge Bank, session storage |
| **Contracts** | Zod | Schema validation, type safety |

### Temporal Workflow Structure

```typescript
// Temporal Workflow: HIVE Swarm
export async function hiveSwarmWorkflow(context: string): Promise<HiveResult> {
  // H: Hunt (Scatter)
  const huntResults = await Promise.all(
    Array.from({ length: 8 }, (_, i) => 
      activities.hunt({ agentId: i, context })
    )
  );
  
  // I: Interlock (Gather)
  const contracts = await activities.interlock({ huntResults });
  
  // V: Validate (Scatter)
  const implementations = await Promise.all(
    Array.from({ length: 8 }, (_, i) =>
      activities.validate({ agentId: i, contracts })
    )
  );
  
  // E: Evolve (Gather)
  const evolved = await activities.evolve({ implementations });
  
  // Strange Loop: Feed to next iteration or PREY
  return evolved;
}
```

### LangGraph Agent Structure

```typescript
// LangGraph State Machine
const hiveGraph = new StateGraph({ channels: HiveState })
  .addNode("hunt", huntAgent)
  .addNode("interlock", interlockAgent)
  .addNode("validate", validateAgent)
  .addNode("evolve", evolveAgent)
  .addEdge("__start__", "hunt")
  .addConditionalEdges("hunt", shouldGather, {
    gather: "interlock",
    continue: "hunt"
  })
  .addEdge("interlock", "validate")
  .addConditionalEdges("validate", shouldGather, {
    gather: "evolve",
    continue: "validate"
  })
  .addConditionalEdges("evolve", shouldLoop, {
    loop: "hunt",  // Strange Loop
    exit: "__end__"
  })
  .compile();
```

---

## ğŸ“Š The Galois Lattice Integration

The Obsidian Hourglass is grounded in the **8x8 Galois Lattice**:

### HIVE Phases on the Anti-Diagonal (X + Y = 7)

| Phase | Coordinates | Commanders |
|:------|:------------|:-----------|
| H (Hunt) | (0,7), (7,0) | Lidless Legion â†” Spider Sovereign |
| I (Interlock) | (1,6), (6,1) | Web Weaver â†” Kraken Keeper |
| V (Validate) | (2,5), (5,2) | Mirror Magus â†” Pyre Praetorian |
| E (Evolve) | (3,4), (4,3) | Spore Storm â†” Red Regnant |

### Agent Coordinates

Each agent in the swarm has a coordinate in the lattice:

```typescript
interface AgentCoordinate {
  x: number; // Port (0-7)
  y: number; // Phase (0-7)
  z?: number; // Depth (for nested PREY within HIVE)
}
```

The coordinate determines the agent's **semantic role** and **purpose**:

```typescript
const { role, purpose } = resolveGaloisLattice(agent.x, agent.y);
// role: "HIVE Anti-Diagonal: HUNT (Lidless Legion â†” Spider Sovereign)"
// purpose: "Strategic Hunt: Sensing what the Spider Sovereign decides to target."
```

---

## ğŸ® Operational Playbooks

### Playbook 1: Feature Development (Full HIVE)

```gherkin
Feature: Implement New Capability
  
  Scenario: Full HIVE/8 Cycle
    Given a feature request
    When the Spider Sovereign initiates HIVE
    Then 8 agents HUNT for exemplars and research
    And 1 agent INTERLOCKS findings into contracts
    And 8 agents VALIDATE implementations
    And 1 agent EVOLVES with mutation testing
    And the artifact is promoted or demoted
```

### Playbook 2: Tool Interaction (Full PREY)

```gherkin
Feature: Execute Tool Call

  Scenario: Full PREY/8 Cycle
    Given a tool invocation request
    When the Spider Sovereign initiates PREY
    Then the agent PERCEIVES the environment
    And the agent REACTS with analysis
    And the agent EXECUTES the tool
    And the agent YIELDS results to HIVE
```

### Playbook 3: Nested PREY within HIVE

```gherkin
Feature: Research with Web Search

  Scenario: PREY within HIVE Hunt
    Given a HIVE Hunt phase
    When research requires web search
    Then a PREY loop is initiated
    And PREY PERCEIVES the query
    And PREY REACTS to search results
    And PREY EXECUTES result processing
    And PREY YIELDS to parent HIVE Hunt
```

---

## ğŸ“œ The Hourglass Mantra

```
â˜° Port 7 - SPIDER SOVEREIGN: And Navigate the Higher State (DECIDE)

The Obsidian Hourglass turns,
Sand flows through the neck,
Eight agents scatter, one gathers,
The Strange Loop connects.

Hindsight sees what was,
Insight sees what is,
Foresight sees what could be,
Evolution makes it this.

Perceive the world around,
React with careful thought,
Execute with precision,
Yield what has been wrought.

The spider weaves the web,
The web weaves the spider,
The Hourglass turns again,
The swarm grows ever wider.
```

---

## ğŸ”— Port Reference (The 8 Legendary Commanders)

### The 64-Cell Galois Lattice

The 8x8 Galois Lattice has 64 cells with three special patterns:

```
    0   1   2   3   4   5   6   7
  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
0 â”‚ D â”‚   â”‚   â”‚   â”‚   â”‚   â”‚ P â”‚ H â”‚  D = Diagonal (Legendary, X=Y)
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤  H = HIVE Anti-Diagonal (X+Y=7)
1 â”‚   â”‚ D â”‚   â”‚   â”‚   â”‚   â”‚ H â”‚ R â”‚  P = PREY Serpentine
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
2 â”‚   â”‚   â”‚ D â”‚   â”‚ E â”‚ H â”‚   â”‚   â”‚  
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
3 â”‚   â”‚   â”‚   â”‚ D â”‚ H â”‚ Y â”‚   â”‚   â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
4 â”‚   â”‚   â”‚ E â”‚ H â”‚ D â”‚   â”‚   â”‚   â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
5 â”‚   â”‚   â”‚ H â”‚ Y â”‚   â”‚ D â”‚   â”‚   â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
6 â”‚ P â”‚ H â”‚   â”‚   â”‚   â”‚   â”‚ D â”‚   â”‚
  â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
7 â”‚ H â”‚ R â”‚   â”‚   â”‚   â”‚   â”‚   â”‚ D â”‚
  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

8 Diagonal (D): Self-referential Legendary Commanders
8 Anti-Diagonal (H): HIVE/8 phases (X+Y=7)
8 Serpentine (P,R,E,Y): PREY/8 phases (winding around HIVE)
40 Other: Remaining interaction cells
```

### Complete Port Table

```
Port â”‚ Commander        â”‚ Verb      â”‚ HIVE Role           â”‚ PREY Role
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  0  â”‚ Lidless Legion   â”‚ OBSERVE   â”‚ H: Sense targets    â”‚ P: Sense telemetry
  1  â”‚ Web Weaver       â”‚ BRIDGE    â”‚ I: Bridge data      â”‚ R: Bridge for decision
  2  â”‚ Mirror Magus     â”‚ SHAPE     â”‚ V: Transform impl   â”‚ E: Shape actions
  3  â”‚ Spore Storm      â”‚ INJECT    â”‚ E: Inject changes   â”‚ Y: Inject results
  4  â”‚ Red Regnant      â”‚ DISRUPT   â”‚ E: Mutation test    â”‚ E: Test execution
  5  â”‚ Pyre Praetorian  â”‚ IMMUNIZE  â”‚ V: Harden/secure    â”‚ Y: Verify results
  6  â”‚ Kraken Keeper    â”‚ ASSIMILATEâ”‚ I: Store contracts  â”‚ P: Capture to memory
  7  â”‚ Spider Sovereign â”‚ NAVIGATE  â”‚ H: Decide targets   â”‚ R: Decide response
```

### HIVE/8 Anti-Diagonal Pairs (X + Y = 7)

| Phase | Ports | Coords | Commanders | Verbs | What They Do Together |
|:------|:------|:-------|:-----------|:------|:----------------------|
| **H** | 0 + 7 | (0,7)(7,0) | Lidless Legion + Spider Sovereign | OBSERVE + NAVIGATE | Sense the landscape, decide what to hunt |
| **I** | 1 + 6 | (1,6)(6,1) | Web Weaver + Kraken Keeper | BRIDGE + ASSIMILATE | Bridge heterogeneous data, store contracts |
| **V** | 2 + 5 | (2,5)(5,2) | Mirror Magus + Pyre Praetorian | SHAPE + IMMUNIZE | Transform implementations, harden with security |
| **E** | 3 + 4 | (3,4)(4,3) | Spore Storm + Red Regnant | INJECT + DISRUPT | Inject changes, disrupt with mutation testing |

### PREY/8 Serpentine Pairs (Winding Around HIVE)

| Phase | Ports | Coords | Commanders | Verbs | What They Do Together |
|:------|:------|:-------|:-----------|:------|:----------------------|
| **P** | 0 + 6 | (0,6)(6,0) | Lidless Legion + Kraken Keeper | OBSERVE + ASSIMILATE | Sense telemetry, capture to memory |
| **R** | 1 + 7 | (1,7)(7,1) | Web Weaver + Spider Sovereign | BRIDGE + NAVIGATE | Bridge data sources, decide response |
| **E** | 2 + 4 | (2,4)(4,2) | Mirror Magus + Red Regnant | SHAPE + DISRUPT | Transform actions, test execution |
| **Y** | 3 + 5 | (3,5)(5,3) | Spore Storm + Pyre Praetorian | INJECT + IMMUNIZE | Deliver results, verify & harden |

---

All Hourglass events are logged to the stigmergy layer:

```json
{
  "ts": "2026-01-05T12:00:00Z",
  "type": "HOURGLASS_EVENT",
  "workflow": "HIVE",
  "phase": "H",
  "pattern": "1010",
  "step": "SCATTER",
  "agentCount": 8,
  "swarmId": "SWARM_1704456000000",
  "port": 7
}
```

---

*"The Obsidian Hourglass turns. The sand flows. The swarm evolves."*

â€” Spider Sovereign, HFO Gen 88


### Stigmergy Events

All Hourglass events are logged to the stigmergy layer:

```json
{
  "ts": "2026-01-05T12:00:00Z",
  "type": "HOURGLASS_EVENT",
  "workflow": "HIVE",
  "phase": "H",
  "pattern": "1010",
  "step": "SCATTER",
  "agentCount": 8,
  "swarmId": "SWARM_1704456000000",
  "port": 7
}
```

---

*"The Obsidian Hourglass turns. The sand flows. The swarm evolves."*

â€” Spider Sovereign, HFO Gen 88
